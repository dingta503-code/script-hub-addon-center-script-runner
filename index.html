<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>เว็บแจกสคริปต์ & ตัวรัน</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Prompt:wght@400;600&display=swap');

*{margin:0;padding:0;box-sizing:border-box;font-family:'Prompt',sans-serif;}
body{height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#0a0a0f,#1a1a2f); color:#fff;}

.authCard{
    background:rgba(20,25,35,0.95);
    border-radius:16px;
    padding:32px;
    width:100%;
    max-width:450px;
    box-shadow:0 15px 40px rgba(0,0,0,0.7);
    display:flex;
    flex-direction:column;
    gap:20px;
    transform: translateY(-20px);
    opacity:0;
    animation: fadeIn 0.6s forwards;
}
@keyframes fadeIn{ to {transform: translateY(0); opacity:1;} }

.authCard h2{color:#ffcc00; font-size:24px; margin-bottom:6px; text-align:center;}
.authCard p.muted{color:#aaa; font-size:13px; margin-bottom:12px; text-align:center;}

.authForm{display:flex; flex-direction:column; gap:12px;}
.authForm input{
    padding:12px;
    border-radius:10px;
    border:none;
    background:rgba(255,255,255,0.05);
    color:#fff;
    font-size:14px;
    transition:0.3s;
}
.authForm input:focus{
    outline:none;
    background:rgba(255,255,255,0.12);
}
.authForm button{
    padding:12px;
    border-radius:10px;
    border:none;
    background:#ffcc00;
    color:#000;
    font-weight:700;
    cursor:pointer;
    transition:0.3s;
}
.authForm button:hover{background:#e6b800;}
.btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.15);color:#fff;}
.small{font-size:13px;color:#aaa;text-align:center;}

.form-toggle{
    display:flex;
    justify-content:center;
    gap:12px;
    margin-bottom:12px;
}
.form-toggle button{
    background:transparent;
    border:none;
    color:#aaa;
    font-weight:600;
    cursor:pointer;
    padding:6px 12px;
    border-radius:8px;
    transition:0.3s;
}
.form-toggle button.active{
    background:#ffcc00;
    color:#000;
}

.adminPanel{
    display:none;
    flex-direction:column;
    gap:12px;
    background:rgba(255,255,255,0.05);
    padding:12px;
    border-radius:10px;
}
.adminPanel h3{color:#ffcc00;}
.adminPanel input{color:#000;}
.adminPanel button{background:#ffcc00;color:#000;}
.searchBox{display:flex;gap:8px;margin-bottom:12px;}
</style>
</head>
<body>

<div class="authCard">
  <h2 id="authTitle">เข้าสู่ระบบ</h2>
  <p class="muted">ต้องสมัครก่อนใช้งานเว็บ — ข้อมูลเก็บในเครื่อง (localStorage)</p>

  <div class="form-toggle">
    <button id="toggleLogin" class="active">ล็อกอิน</button>
    <button id="toggleRegister">สมัครสมาชิก</button>
  </div>

  <!-- LOGIN FORM -->
  <div id="loginForm" class="authForm">
    <input id="loginUser" type="text" placeholder="ชื่อผู้ใช้">
    <input id="loginPass" type="password" placeholder="รหัสผ่าน">
    <button id="btnLogin">เข้าสู่ระบบ</button>
    <div class="small">หากยังไม่มีบัญชีให้กด "สมัครสมาชิก"</div>
  </div>

  <!-- REGISTER FORM -->
  <div id="registerForm" class="authForm" style="display:none">
    <input id="regUser" type="text" placeholder="ตั้งชื่อผู้ใช้">
    <input id="regPass" type="password" placeholder="ตั้งรหัสผ่าน">
    <button id="btnRegister">สมัคร</button>
    <div class="small">บัญชีเก็บในเครื่อง — ล้างเบราว์เซอร์หายหมด</div>
  </div>

  <!-- ADMIN PANEL -->
  <div id="adminPanel" class="adminPanel">
    <h3>หลังบ้านแอดมิน</h3>
    <input id="categoryInput" type="text" placeholder="เพิ่มหมวดหมู่">
    <button id="addCategoryBtn">เพิ่มหมวดหมู่</button>
    <div class="searchBox">
      <input id="searchInput" type="text" placeholder="ค้นหาสคริปต์/ตัวรัน">
      <button id="searchBtn">ค้นหา</button>
    </div>
    <div id="categoryList"></div>
  </div>
</div>

<script>
const CONFIG = {
  STORAGE_KEY:"sr_site_v3_users",
  ADMIN_CREDENTIALS:{username:"admin", password:"A9f!x7Kp#2Lq"},
  CATEGORY_KEY:"sr_site_v3_categories",
};

let state={currentUser:null};

// HELPERS
const $ = (s)=>document.querySelector(s);
function loadUsers(){
    const raw=localStorage.getItem(CONFIG.STORAGE_KEY);
    let users=raw?JSON.parse(raw):[];
    if(!users.find(u=>u.username===CONFIG.ADMIN_CREDENTIALS.username)){
        users.push({username:CONFIG.ADMIN_CREDENTIALS.username,password:CONFIG.ADMIN_CREDENTIALS.password,isAdmin:true});
        localStorage.setItem(CONFIG.STORAGE_KEY,JSON.stringify(users));
    }
    return users;
}
function saveUsers(users){ localStorage.setItem(CONFIG.STORAGE_KEY,JSON.stringify(users)); }

function loadCategories(){
    const raw = localStorage.getItem(CONFIG.CATEGORY_KEY);
    return raw?JSON.parse(raw):[];
}
function saveCategories(categories){
    localStorage.setItem(CONFIG.CATEGORY_KEY,JSON.stringify(categories));
}
function renderCategories(){
    const list = $('#categoryList');
    list.innerHTML='';
    const cats = loadCategories();
    cats.forEach(c=>{
        const div=document.createElement('div');
        div.textContent=c.name;
        list.appendChild(div);
    });
}

// TOGGLE FORM
$('#toggleLogin').onclick=()=>{$('#loginForm').style.display='flex';$('#registerForm').style.display='none';$('#toggleLogin').classList.add('active');$('#toggleRegister').classList.remove('active');}
$('#toggleRegister').onclick=()=>{$('#loginForm').style.display='none';$('#registerForm').style.display='flex';$('#toggleLogin').classList.remove('active');$('#toggleRegister').classList.add('active');}

// REGISTER
$('#btnRegister').onclick=()=>{
    const u=$('#regUser').value.trim(),p=$('#regPass').value;
    if(!u||!p){alert('กรอกชื่อและรหัสผ่าน');return;}
    const users=loadUsers();
    if(users.find(x=>x.username===u)){alert('มีชื่อผู้ใช้นี้แล้ว');return;}
    users.push({username:u,password:p,isAdmin:false});
    saveUsers(users);
    alert('สมัครเรียบร้อย ล็อกอินได้เลย');
    $('#regUser').value='';$('#regPass').value='';
    $('#toggleLogin').click();
}

// LOGIN
$('#btnLogin').onclick=()=>{
    const u=$('#loginUser').value.trim(),p=$('#loginPass').value;
    if(!u||!p){ alert('กรอกชื่อและรหัสผ่าน'); return; }
    const users=loadUsers();
    const user = users.find(x=>x.username===u && x.password===p);
    if(!user){ alert('ชื่อผู้ใช้หรือรหัสผ่านไม่ถูกต้อง'); return; }
    state.currentUser={username:user.username,isAdmin:!!user.isAdmin};
    alert(`เข้าสู่ระบบสำเร็จ!${user.isAdmin?" (Admin)":""}`);
    $('#loginUser').value=''; $('#loginPass').value='';
    if(user.isAdmin){$('#adminPanel').style.display='flex'; renderCategories();}
}

// ADMIN ACTIONS
$('#addCategoryBtn').onclick=()=>{
    const name = $('#categoryInput').value.trim();
    if(!name){alert('กรอกชื่อหมวดหมู่'); return;}
    const cats = loadCategories();
    cats.push({name});
    saveCategories(cats);
    $('#categoryInput').value='';
    renderCategories();
}

// SEARCH
$('#searchBtn').onclick=()=>{
    const term = $('#searchInput').value.toLowerCase();
    const cats = loadCategories().filter(c=>c.name.toLowerCase().includes(term));
    const list=$('#categoryList'); list.innerHTML='';
    cats.forEach(c=>{const div=document.createElement('div'); div.textContent=c.name; list.appendChild(div);});
}
</script>

</body>
</html>
