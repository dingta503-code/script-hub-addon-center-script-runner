<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>เว็บแจกสคริปต์ & ตัวรัน</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Prompt:wght@400;600&display=swap');
*{margin:0;padding:0;box-sizing:border-box;font-family:'Prompt',sans-serif;}
body{background:#121212;color:#fff;}
header{padding:16px;background:#1c1c1c;text-align:center;position:sticky;top:0;z-index:100;box-shadow:0 2px 8px rgba(0,0,0,0.5);}
h1,h2{color:#fdd835;}
.container{padding:20px;max-width:1000px;margin:auto;}
input[type=text],input[type=password]{width:100%;padding:10px;margin:10px 0;border-radius:8px;border:none;background:#222;color:#fff;}
button{padding:6px 12px;border:none;border-radius:6px;cursor:pointer;background:#0288d1;color:#fff;margin-left:6px;transition:0.2s;}
button:hover{background:#03a9f4;}
.authCard{background:#1c1c1c;border-radius:16px;padding:32px;width:100%;max-width:400px;box-shadow:0 8px 20px rgba(0,0,0,0.7);margin:auto;display:flex;flex-direction:column;gap:24px;}
.authForm{display:flex;flex-direction:column;gap:12px;}
.small{font-size:13px;color:#aaa;text-align:center;}
.form-toggle{display:flex;justify-content:center;gap:12px;margin-bottom:12px;}
.form-toggle button{background:transparent;border:none;color:#aaa;font-weight:600;cursor:pointer;padding:6px 12px;border-radius:8px;transition:0.3s;}
.form-toggle button.active{background:#0288d1;color:#fff;}
.tab-container{display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap;z-index:1;}
.tab{padding:8px 16px;background:#222;border-radius:12px;cursor:pointer;transition:0.3s;color:#fff;}
.tab.active{background:#03a9f4;color:#fff;}
.item-container{display:flex;flex-wrap:wrap;gap:12px;z-index:0;}
.item{padding:12px;background:#222;border-radius:12px;flex:1 1 250px;min-width:200px;display:flex;flex-direction:column;gap:6px;box-shadow:0 4px 12px rgba(0,0,0,0.5);}
.item img{width:100%;border-radius:8px;object-fit:cover;max-height:150px;}
.item b{color:#ffd54f;}
.item p{color:#ccc;}
.item button{margin-top:4px;background:#0288d1;color:#fff;border-radius:6px;}
.item button:hover{background:#03a9f4;}
.admin-panel{background:#1c1c1c;padding:16px;margin-bottom:20px;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.5);}
.admin-panel h3{color:#ffd54f;margin-bottom:8px;}
.admin-panel button{margin:4px 4px 4px 0;background:#03a9f4;color:#fff;border-radius:6px;padding:6px 10px;}
.admin-panel button:hover{background:#0288d1;}
#itemPopup{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);justify-content:center;align-items:center;z-index:200;}
#itemPopup>div{background:#1e1e1e;padding:20px;border-radius:12px;max-width:400px;width:90%;color:#fff;}
#itemPopup input[type=text]{width:100%;padding:8px;margin:6px 0;background:#222;border:none;border-radius:8px;color:#fff;}
</style>
</head>
<body>

<div id="mainContent">

<!-- LOGIN / REGISTER -->
<div class="authCard" id="authCard">
<h2 id="authTitle">เข้าสู่ระบบ</h2>
<div class="form-toggle">
<button id="toggleLogin" class="active">ล็อกอิน</button>
<button id="toggleRegister">สมัครสมาชิก</button>
</div>

<div id="loginForm" class="authForm">
<input id="loginUser" type="text" placeholder="ชื่อผู้ใช้">
<input id="loginPass" type="password" placeholder="รหัสผ่าน">
<button id="btnLogin">เข้าสู่ระบบ</button>
<div class="small">หากยังไม่มีบัญชีให้กด "สมัครสมาชิก"</div>
</div>

<div id="registerForm" class="authForm" style="display:none">
<input id="regUser" type="text" placeholder="ตั้งชื่อผู้ใช้">
<input id="regPass" type="password" placeholder="ตั้งรหัสผ่าน">
<button id="btnRegister">สมัคร</button>
<div class="small">บัญชีเก็บในเครื่อง — ล้างเบราว์เซอร์หายหมด</div>
</div>
</div>

<!-- USER / ADMIN INTERFACE -->
<div id="userInterface" style="display:none;">
<header><h1>สคริปต์ & ตัวรัน</h1></header>
<div class="container">

<!-- Admin Panel -->
<div id="adminPanel" class="admin-panel" style="display:none;">
<h3>หลังบ้าน (Admin)</h3>
<button onclick="addCategory()">+ สร้างหมวดหมู่ใหม่</button>
<button onclick="openPopupAddItem()">+ เพิ่มไอเท็มใหม่</button>
<div id="categoryAdminList"></div>
</div>

<input type="text" id="searchInput" placeholder="ค้นหาชื่อสคริปต์/ตัวรัน...">

<!-- Tabs / หมวดหมู่แนวนอน -->
<div class="tab-container" id="tabContainer"></div>

<!-- Items -->
<div class="item-container" id="itemContainer"></div>

</div>
</div>
</div>

<!-- POPUP ADD / EDIT ITEM -->
<div id="itemPopup">
<div>
<h3 id="popupTitle">เพิ่มไอเท็ม</h3>
<label>ชื่อ:</label>
<input id="popupName" type="text" placeholder="ชื่อสคริปต์ / ตัวรัน / ติดต่อ">
<label>คำอธิบาย:</label>
<input id="popupDesc" type="text" placeholder="คำอธิบายสั้นๆ">
<label>อัปโหลดภาพ:</label>
<input id="popupImageFile" type="file" accept="image/*">
<img id="popupPreview" src="" style="width:100%;margin-top:6px;display:none;border-radius:8px;object-fit:cover;">
<label>ประเภท:</label>
<select id="popupType" style="width:100%;padding:8px;margin:6px 0;background:#222;border:none;border-radius:8px;color:#fff;">
<option value="copy">คัดลอกข้อความ</option>
<option value="download">ดาวน์โหลดไฟล์</option>
<option value="link">ลิงก์ติดต่อ</option>
</select>
<label>ข้อความ / ลิงก์ / URL ดาวน์โหลด:</label>
<input id="popupExtraInput" type="text" placeholder="ข้อความ / ลิงก์ / URL ดาวน์โหลด">
<div style="margin-top:10px;text-align:right;">
<button onclick="closePopup()" style="background:#555;">ยกเลิก</button>
<button id="popupSaveBtn" style="background:#03a9f4;">บันทึก</button>
</div>
</div>
</div>

<script>
// CONFIG
const CONFIG={STORAGE_KEY:"sr_site_v11_users",ADMIN_CREDENTIALS:{username:"admin",password:"A9f!x7Kp#2Lq"}};
let state={currentUser:null,activeTab:0};

// SOUND
const clickSound = new Audio("https://www.soundjay.com/button/beep-07.mp3");

// HELPERS
const $=(s)=>document.querySelector(s);
function playClick(){clickSound.play();}

// USERS
function loadUsers(){const raw=localStorage.getItem(CONFIG.STORAGE_KEY);let users=raw?JSON.parse(raw):[];if(!users.find(u=>u.username===CONFIG.ADMIN_CREDENTIALS.username)){users.push({username:CONFIG.ADMIN_CREDENTIALS.username,password:CONFIG.ADMIN_CREDENTIALS.password,isAdmin:true});localStorage.setItem(CONFIG.STORAGE_KEY,JSON.stringify(users));}return users;}
function saveUsers(users){localStorage.setItem(CONFIG.STORAGE_KEY,JSON.stringify(users));}

// LOGIN / REGISTER
$('#toggleLogin').onclick=()=>{$('#loginForm').style.display='flex';$('#registerForm').style.display='none';$('#toggleLogin').classList.add('active');$('#toggleRegister').classList.remove('active');playClick();}
$('#toggleRegister').onclick=()=>{$('#loginForm').style.display='none';$('#registerForm').style.display='flex';$('#toggleLogin').classList.remove('active');$('#toggleRegister').classList.add('active');playClick();}
$('#btnRegister').onclick=()=>{
  playClick();
  const u=$('#regUser').value.trim(),p=$('#regPass').value;if(!u||!p){alert('กรอกชื่อและรหัสผ่าน');return;}
