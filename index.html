<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>เว็บแจกสคริปต์ & ตัวรัน</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Prompt:wght@400;600&display=swap');
*{margin:0;padding:0;box-sizing:border-box;font-family:'Prompt',sans-serif;}
body{background:#121212;color:#fff;}
header{padding:16px;background:#1c1c1c;text-align:center;position:sticky;top:0;z-index:100;box-shadow:0 2px 8px rgba(0,0,0,0.5);}
h1,h2{color:#fdd835;}
.container{padding:20px;max-width:1000px;margin:auto;}
input[type=text],input[type=password]{width:100%;padding:10px;margin:10px 0;border-radius:8px;border:none;background:#222;color:#fff;}
button{padding:6px 12px;border:none;border-radius:6px;cursor:pointer;background:#0288d1;color:#fff;margin-left:6px;transition:0.2s;}
button:hover{background:#03a9f4;}
.authCard{background:#1c1c1c;border-radius:16px;padding:32px;width:100%;max-width:400px;box-shadow:0 8px 20px rgba(0,0,0,0.7);margin:auto;display:flex;flex-direction:column;gap:24px;}
.authForm{display:flex;flex-direction:column;gap:12px;}
.small{font-size:13px;color:#aaa;text-align:center;}
.form-toggle{display:flex;justify-content:center;gap:12px;margin-bottom:12px;}
.form-toggle button{background:transparent;border:none;color:#aaa;font-weight:600;cursor:pointer;padding:6px 12px;border-radius:8px;transition:0.3s;}
.form-toggle button.active{background:#0288d1;color:#fff;}
.tab-container{display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap;z-index:1;}
.tab{padding:8px 16px;background:#222;border-radius:12px;cursor:pointer;transition:0.3s;color:#fff;}
.tab.active{background:#03a9f4;color:#fff;}
.item-container{display:flex;flex-wrap:wrap;gap:12px;z-index:0;}
.item{padding:12px;background:#222;border-radius:12px;flex:1 1 250px;min-width:200px;display:flex;flex-direction:column;gap:6px;box-shadow:0 4px 12px rgba(0,0,0,0.5);}
.item img{width:100%;border-radius:8px;object-fit:cover;max-height:150px;}
.item b{color:#ffd54f;}
.item p{color:#ccc;}
.item button{margin-top:4px;background:#0288d1;color:#fff;border-radius:6px;}
.item button:hover{background:#03a9f4;}
.admin-panel{background:#1c1c1c;padding:16px;margin-bottom:20px;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.5);}
.admin-panel h3{color:#ffd54f;margin-bottom:8px;}
.admin-panel button{margin:4px 4px 4px 0;background:#03a9f4;color:#fff;border-radius:6px;padding:6px 10px;}
.admin-panel button:hover{background:#0288d1;}
</style>
</head>
<body>

<div id="mainContent">

<!-- LOGIN / REGISTER -->
<div class="authCard" id="authCard">
<h2 id="authTitle">เข้าสู่ระบบ</h2>
<div class="form-toggle">
<button id="toggleLogin" class="active">ล็อกอิน</button>
<button id="toggleRegister">สมัครสมาชิก</button>
</div>

<div id="loginForm" class="authForm">
<input id="loginUser" type="text" placeholder="ชื่อผู้ใช้">
<input id="loginPass" type="password" placeholder="รหัสผ่าน">
<button id="btnLogin">เข้าสู่ระบบ</button>
<div class="small">หากยังไม่มีบัญชีให้กด "สมัครสมาชิก"</div>
</div>

<div id="registerForm" class="authForm" style="display:none">
<input id="regUser" type="text" placeholder="ตั้งชื่อผู้ใช้">
<input id="regPass" type="password" placeholder="ตั้งรหัสผ่าน">
<button id="btnRegister">สมัคร</button>
<div class="small">บัญชีเก็บในเครื่อง — ล้างเบราว์เซอร์หายหมด</div>
</div>
</div>

<!-- USER / ADMIN INTERFACE -->
<div id="userInterface" style="display:none;">
<header><h1>สคริปต์ & ตัวรัน</h1></header>
<div class="container">

<!-- Admin Panel -->
<div id="adminPanel" class="admin-panel" style="display:none;">
<h3>หลังบ้าน (Admin)</h3>
<button onclick="addCategory()">+ สร้างหมวดหมู่ใหม่</button>
<div id="categoryAdminList"></div>
</div>

<input type="text" id="searchInput" placeholder="ค้นหาชื่อสคริปต์/ตัวรัน...">

<!-- Tabs / หมวดหมู่แนวนอน -->
<div class="tab-container" id="tabContainer"></div>

<!-- Items -->
<div class="item-container" id="itemContainer"></div>

</div>
</div>
</div>

<script>
// CONFIG
const CONFIG={STORAGE_KEY:"sr_site_v11_users",ADMIN_CREDENTIALS:{username:"admin",password:"A9f!x7Kp#2Lq"}};
let state={currentUser:null,activeTab:0};

// HELPERS
const $=(s)=>document.querySelector(s);
function loadUsers(){const raw=localStorage.getItem(CONFIG.STORAGE_KEY);let users=raw?JSON.parse(raw):[];if(!users.find(u=>u.username===CONFIG.ADMIN_CREDENTIALS.username)){users.push({username:CONFIG.ADMIN_CREDENTIALS.username,password:CONFIG.ADMIN_CREDENTIALS.password,isAdmin:true});localStorage.setItem(CONFIG.STORAGE_KEY,JSON.stringify(users));}return users;}
function saveUsers(users){localStorage.setItem(CONFIG.STORAGE_KEY,JSON.stringify(users));}

// TOGGLE FORM
$('#toggleLogin').onclick=()=>{$('#loginForm').style.display='flex';$('#registerForm').style.display='none';$('#toggleLogin').classList.add('active');$('#toggleRegister').classList.remove('active');}
$('#toggleRegister').onclick=()=>{$('#loginForm').style.display='none';$('#registerForm').style.display='flex';$('#toggleLogin').classList.remove('active');$('#toggleRegister').classList.add('active');}

// REGISTER
$('#btnRegister').onclick=()=>{
  const u=$('#regUser').value.trim(),p=$('#regPass').value;if(!u||!p){alert('กรอกชื่อและรหัสผ่าน');return;}
  const users=loadUsers();if(users.find(x=>x.username===u)){alert('มีชื่อผู้ใช้นี้แล้ว');return;}
  users.push({username:u,password:p,isAdmin:false});saveUsers(users);alert('สมัครเรียบร้อย ล็อกอินได้เลย');$('#regUser').value='';$('#regPass').value='';$('#toggleLogin').click();
}

// LOGIN
$('#btnLogin').onclick=()=>{
  const u=$('#loginUser').value.trim(),p=$('#loginPass').value;if(!u||!p){alert('กรอกชื่อและรหัสผ่าน');return;}
  const users=loadUsers();const user=users.find(x=>x.username===u&&x.password===p);if(!user){alert('ชื่อผู้ใช้หรือรหัสผ่านไม่ถูกต้อง');return;}
  state.currentUser={username:user.username,isAdmin:!!user.isAdmin};localStorage.setItem("currentUser",JSON.stringify(state.currentUser));
  $('#authCard').style.display='none';$('#userInterface').style.display='block';if(state.currentUser.isAdmin) $('#adminPanel').style.display='block';
  initInterface();
}

// CATEGORIES
let categories=JSON.parse(localStorage.getItem("categories")||`[
{"name":"สคริปต์","type":"copy","items":[{"name":"Script A","description":"คำอธิบาย Script A","copyText":"ข้อความ Script A","image":"https://via.placeholder.com/300x150"}]},
{"name":"ตัวรัน","type":"download","items":[{"name":"Runner X","description":"คำอธิบาย Runner X","downloadLink":"https://example.com/runnerX.exe","image":"https://via.placeholder.com/300x150"}]},
{"name":"ติดต่อ","type":"link","items":[{"name":"Discord แอดมิน","description":"คลิกเพื่อไปยัง Discord","link":"https://discord.gg/rtfpN9pT35","image":"https://via.placeholder.com/150"}]}
]`);
function saveCategories(){localStorage.setItem("categories",JSON.stringify(categories));}

// RENDER TABS
function renderTabs(){const tabContainer=$('#tabContainer');tabContainer.innerHTML='';categories.forEach((cat,ci)=>{const tab=document.createElement('div');tab.className='tab';tab.textContent=cat.name;if(ci===state.activeTab) tab.classList.add('active');tab.onclick=()=>{state.activeTab=ci;renderTabs();renderItems();};tabContainer.appendChild(tab);});}

// RENDER ITEMS
function renderItems(){const container=$('#itemContainer');container.innerHTML='';const cat=categories[state.activeTab];if(!cat) return;cat.items.forEach((item,index)=>{const div=document.createElement('div');div.className='item';if(item.image) div.innerHTML=`<img src="${item.image}">`;div.innerHTML+=`<b>${item.name}</b><p>${item.description}</p>`;
if(cat.type==="copy"&&item.copyText){const btn=document.createElement('button');btn.textContent='คัดลอกข้อความ';btn.onclick=()=>{navigator.clipboard.writeText(item.copyText);alert("คัดลอกเรียบร้อย");};div.appendChild(btn);}
if(cat.type==="download"&&item.downloadLink){const btn=document.createElement('button');btn.textContent='ดาวน์โหลด';btn.onclick=()=>{window.open(item.downloadLink,'_blank');};div.appendChild(btn);}
if(cat.type==="link"&&item.link){const btn=document.createElement('button');btn.textContent='ติดต่อ';btn.onclick=()=>{window.open(item.link,'_blank');};div.appendChild(btn);}
if(state.currentUser.isAdmin){const editBtn=document.createElement('button');editBtn.textContent='แก้ไข';editBtn.onclick=()=>editItem(state.activeTab,index);const delBtn=document.createElement('button');delBtn.textContent='ลบ';delBtn.onclick=()=>{if(confirm("ลบไอเทม?")){categories[state.activeTab].items.splice(index,1);saveCategories();renderItems();renderAdminPanel();}};div.appendChild(editBtn);div.appendChild(delBtn);}
container.appendChild(div);});}

// ADMIN PANEL
function renderAdminPanel(){const panel=$('#categoryAdminList');panel.innerHTML='';categories.forEach((cat,ci)=>{const div=document.createElement('div');div.innerHTML=`<b>${cat.name}</b> <button onclick="editCategory(${ci})">แก้ไข</button> <button onclick="deleteCategory(${ci})">ลบ</button>`;panel.appendChild(div);});}

// ADD CATEGORY
function addCategory(){
  const name=prompt("ชื่อหมวดหมู่:");if(!name)return;
  let type=prompt("เลือกประเภทหมวดหมู่ (copy / download / link):","copy");
  if(!["copy","download","link"].includes(type)) type="copy";
  categories.push({name,type,items:[]});saveCategories();renderTabs();renderAdminPanel();
}

// EDIT CATEGORY
function editCategory(ci){const cat=categories[ci];const name=prompt("แก้ไขชื่อหมวดหมู่:",cat.name);if(!name)return;let type=prompt("แก้ไขประเภทหมวดหมู่ (copy / download / link):",cat.type);if(!["copy","download","link"].includes(type)) type=cat.type;cat.name=name;cat.type=type;saveCategories();renderTabs();renderAdminPanel();}

// DELETE CATEGORY
function deleteCategory(ci){if(confirm("ลบหมวดหมู่นี้?")){categories.splice(ci,1);saveCategories();renderTabs();renderAdminPanel();if(state.activeTab>=categories.length) state.activeTab=categories.length-1;renderItems();}}

// EDIT ITEM
function editItem(catIndex,index){const item=categories[catIndex].items[index];const name=prompt("ชื่อ:",item.name);if(!name)return;const desc=prompt("คำอธิบาย:",item.description);item.name=name;item.description=desc;saveCategories();renderItems();renderAdminPanel();}

// INIT
function initInterface(){renderTabs();renderItems();if(state.currentUser.isAdmin) renderAdminPanel();}
$('#searchInput').addEventListener('input',e=>{const query=e.target.value.toLowerCase();const filtered=categories.map(cat=>({name:cat.name,items:cat.items.filter(i=>i.name.toLowerCase().includes(query))}));renderItemsFiltered(filtered);});
function renderItemsFiltered(filtered){const container=$('#itemContainer');container.innerHTML='';const cat=filtered[state.activeTab];if(!cat)return;cat.items.forEach((item,index)=>{const div=document.createElement('div');div.className='item';if(item.image) div.innerHTML=`<img src="${item.image}">`;div.innerHTML+=`<b>${item.name}</b><p>${item.description}</p>`;if(item.copyText){const btn=document.createElement('button');btn.textContent='คัดลอกข้อความ';btn.onclick=()=>{navigator.clipboard.writeText(item.copyText);alert("คัดลอกเรียบร้อย");};div.appendChild(btn);}if(item.downloadLink){const btn=document.createElement('button');btn.textContent='ดาวน์โหลด';btn.onclick=()=>{window.open(item.downloadLink,'_blank');};div.appendChild(btn);}if(item.link){const btn=document.createElement('button');btn.textContent='ติดต่อ';btn.onclick=()=>{window.open(item.link,'_blank');};div.appendChild(btn);}container.appendChild(div);});}
</script>

</body>
</html>
